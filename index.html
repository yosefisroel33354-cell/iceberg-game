<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Iceberg Clicker</title>
    <link rel="stylesheet" href="style.css?v=8">
    
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
</head>
<body>
    <div class="game-container">
        
        <div id="loading-screen" style="position:fixed; top:0; left:0; width:100%; height:100%; background:#090a0f; z-index:9999; display:flex; justify-content:center; align-items:center; flex-direction:column; color:white;">
            <div class="loader" style="font-size: 40px; margin-bottom: 20px;">â„ï¸</div>
            <p>Loading Iceberg...</p>
            <p id="debug-log" style="font-size: 10px; color: #ff5555; margin-top: 20px; text-align: center; max-width: 80%;"></p>
        </div>

        <div class="header">
            <button id="btn-music" class="music-btn">ğŸ”‡</button>
            <div class="user-info">
                <span id="username">@user</span>
            </div>
            <div class="score-container">
                <span class="icon">â„ï¸</span>
                <h1 id="score">0</h1>
            </div>
            
            <div class="level-container">
                <h3 id="level-name">Ice Cube ğŸ§Š</h3>
                <div class="level-bar">
                    <div class="level-fill" id="level-fill" style="width: 0%;"></div>
                </div>
            </div>

            <div class="passive-income">
                <span>ğŸ§Š / sec: </span><span id="income-val">0</span>
            </div>
        </div>

        <div id="game-screen" class="screen active">
            <div class="click-area">
                <div class="iceberg" id="click-btn">ğŸ§Š</div>
            </div>
        </div>

        <div id="shop-screen" class="screen">
            <h2>Upgrades</h2>
            <div class="shop-items" id="shop-list"></div>
        </div>

        <div id="friends-screen" class="screen">
            <h2>Invite Friends</h2>
            <div class="invite-card">
                <p>Invite a friend and get <br> <span style="color: #ffd700;">+2500 ğŸ§Š</span> for each!</p>
                <button class="action-btn" onclick="inviteFriend()">Invite Friend ğŸ“¨</button>
            </div>
            <div class="friends-list">
                <h3>Your Friends</h3>
                <div id="friends-list-container">
                    <div class="empty-state">Loading...</div>
                </div>
            </div>
        </div>

        <div class="footer">
            <div class="energy-bar-container">
                <span>Energy âš¡</span>
                <div class="energy-bar">
                    <div class="energy-fill" id="energy-fill" style="width: 100%;"></div>
                </div>
                <span id="energy-val">1000/1000</span>
            </div>
            <div class="nav-menu">
                <button class="nav-btn active" id="btn-mine" onclick="switchScreen('mine')">â›ï¸ Mine</button>
                <button class="nav-btn" id="btn-shop" onclick="switchScreen('shop')">ğŸ›’ Shop</button>
                <button class="nav-btn" id="btn-friends" onclick="switchScreen('friends')">ğŸ‘¥ Friends</button>
            </div>
        </div>
    </div>

    <script src="script.js?v=10"></script>
    
    <script>
        window.onerror = function(msg, url, line) {
            document.getElementById('debug-log').innerText = "ERROR: " + msg + " (Line: " + line + ")";
        };
    </script>
</body>
</html>